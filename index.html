<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='The R language includes a set of defined types, but the language
    itself is "absurdly dynamic" (Turcotte &amp; Vitek (2019)
    &lt;doi:10.1145/3340670.3342426&gt;), and lacks any way to specify which types are
    expected by any expression. The typetracer package enables code to be
    traced to extract detailed information on the properties of parameters
    passed to R functions. typetracer can trace individual functions or
    entire packages.'>
<title>Trace Function Parameter Types • typetracer</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Trace Function Parameter Types">
<meta property="og:description" content='The R language includes a set of defined types, but the language
    itself is "absurdly dynamic" (Turcotte &amp; Vitek (2019)
    &lt;doi:10.1145/3340670.3342426&gt;), and lacks any way to specify which types are
    expected by any expression. The typetracer package enables code to be
    traced to extract detailed information on the properties of parameters
    passed to R functions. typetracer can trace individual functions or
    entire packages.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">typetracer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/nse.html">Non-Standard Evaluation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mpadge/typetracer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="typetracer">typetracer<a class="anchor" aria-label="anchor" href="#typetracer"></a>
</h1></div>
<p><code>typetracer</code> is an R package to trace function parameter types. The R language includes <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Basic-types" class="external-link">a set of defined types</a>, but the language itself is <a href="https://dl.acm.org/doi/pdf/10.1145/3340670.3342426" class="external-link">“absurdly dynamic”</a>[1], and lacks any way to specify which types are expected by any expression. The <code>typetracer</code> package enables code to be traced to extract detailed information on the properties of parameters passed to R functions. <code>typetracer</code> can trace individual functions or entire packages, as demonstrated below.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The stable version of the package can be installed with one of the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stable version from CRAN:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span> (<span class="st">"typetrace"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Current development version from r-universe:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span> (</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"typetracer"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">repos =</span> <span class="fu">c</span> (<span class="st">"https://mpadge.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Alternatively, for those who prefer to use other source code platforms, the package can also be installed by running any one of the following lines:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_git</span> (<span class="st">"https://git.sr.ht/~mpadge/dodgr"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_git</span> (<span class="st">"https://codeberg.org/UrbanAnalyst/dodgr"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_bitbucket</span> (<span class="st">"UrbanAnalyst/dodgr"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_gitlab</span> (<span class="st">"UrbanAnalyst/dodgr"</span>)</span></code></pre></div>
<p>The package can then loaded for use by calling <code>library</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (typetracer)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-1---a-single-function">Example #1 - A Single Function<a class="anchor" aria-label="anchor" href="#example-1---a-single-function"></a>
</h2>
<p><code>typetracer</code> works by “injecting” tracing code into the body of a function using <a href="https://mpadge.github.io/typetracer/reference/inject_tracer.html">the <code>inject_tracer()</code> function</a>. Locally-defined functions can be traced by simply passing the functions directly to <code><a href="reference/inject_tracer.html">inject_tracer()</a></code>. The following example includes four parameters, including <code>...</code> to allow passing of additional and entirely arbitrary parameter types and values.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span> (x, y, z, ...) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">*</span> x <span class="sc">+</span> y <span class="sc">*</span> y</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">inject_tracer</span> (f)</span></code></pre></div>
<p>After injecting the <code>typetracer</code> code, calls to the function, <code>f</code>, will “trace” each parameter of the function, by capturing both unevaluated and evaluated representations at the point at which the function is first called. These values can be accessed with <a href="https://mpadge.github.io/typetracer/reference/load_traces.html">the <code>load_traces</code> function</a>, which returns a <code>data.frame</code> object (in <a href="https://tibble.tidyverse.org" class="external-link"><code>tibble</code> format</a>) with one row for each parameter from each function call.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="fu">f</span> (</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="fl">0.</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="st">"blah"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="fu">list</span> (<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="st">"b"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">f =</span> a <span class="sc">~</span> b</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">load_traces</span> ()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 7 × 12</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   trace_number fn_name fn_call_hash par_name class     typeof mode  storage_mode</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">##          &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;    &lt;I&lt;list&gt;&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 1            0 f       uDgEbied     x        &lt;chr [1]&gt; integ… nume… integer     </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2            0 f       uDgEbied     y        &lt;chr [1]&gt; double nume… double      </span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 3            0 f       uDgEbied     z        &lt;chr [1]&gt; NULL   NULL  NULL        </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 4            0 f       uDgEbied     ...      &lt;chr [1]&gt; NULL   NULL  NULL        </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 5            0 f       uDgEbied     a        &lt;chr [1]&gt; chara… char… character   </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 6            0 f       uDgEbied     b        &lt;chr [1]&gt; list   list  list        </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 7            0 f       uDgEbied     f        &lt;chr [1]&gt; langu… call  language    </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 4 more variables: length &lt;int&gt;, formal &lt;named list&gt;, uneval &lt;I&lt;list&gt;&gt;,</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">## #   eval &lt;I&lt;list&gt;&gt;</span></span></code></pre></div>
<p>Each row of the result returned by <code><a href="reference/load_traces.html">load_traces()</a></code> represents one parameter passed to one function call. Each function call itself represents a single “trace” as enumerated by the <code>trace_number</code> column, and also uniquely identified by an arbitrary function call hash (<code>fn_call_hash</code>). The remaining columns of the trace data define the properties of each parameter, <code>p</code>, as:</p>
<ol style="list-style-type: decimal">
<li>
<code>par_name</code>: Name of parameter.</li>
<li>
<code>class</code>: List of classes of parameter.</li>
<li>
<code>typeof</code>: Result of <code>typeof(p)</code>.</li>
<li>
<code>mode</code>: Result of <code>mode(p)</code>.</li>
<li>
<code>storage_mode</code>: Result of <code>storage.mode(p)</code>.</li>
<li>
<code>length</code>: Result of <code>length(p)</code>.</li>
<li>
<code>formal</code>: Result of <code>formals(f)[["p"]]</code>, as named list item with default value where specified.</li>
<li>
<code>uneval</code>: Parameters as passed to the function call prior to evaluation within function environment.</li>
<li>
<code>eval</code>: Evaluated version of parameter.</li>
</ol>
<p>The results above show that all parameters of the function, <code>f()</code>, were successfully traced, including the additional parameters, <code>a</code>, <code>b</code>, and <code>f</code>, passed as part of the <code>...</code> argument. Such additional parameters can be identified through having a <code>"formal"</code> entry of <code>NULL</code>, indicating that they are not part of the formal arguments to the function.</p>
<p>That result can also be used to demonstrate the difference between the unevaluated and evaluated forms of parameters:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>uneval [x<span class="sc">$</span>par_name <span class="sc">%in%</span> <span class="fu">c</span> (<span class="st">"b"</span>, <span class="st">"f"</span>)]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## $b</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "list(a = 1, b = \"b\")"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $f</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "a ~ b"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>eval [x<span class="sc">$</span>par_name <span class="sc">%in%</span> <span class="fu">c</span> (<span class="st">"b"</span>, <span class="st">"f"</span>)]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="do">## $b</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## $b$a</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="do">## $b$b</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "b"</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="do">## $f</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="do">## a ~ b</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="do">## &lt;environment: 0x560b15656ca8&gt;</span></span></code></pre></div>
<p>Unevaluated parameters are generally converted to equivalent character expressions.</p>
<p>The <code>typeof</code>, <code>mode</code>, and <code>storage_mode</code> columns are similar, yet may hold distinct information for certain types of parameters. The conditions under which these values differ are complex, and depend among other things on the version of R itself. <code>typeof</code> alone should generally provide sufficient information, although <a href="https://stackoverflow.com/a/37469255" class="external-link">this list of differences</a> may provide further insight into whether the other columns may provide useful additional information.</p>
<p>Traces themselves are saved in the temporary directory of the current R session, and <a href="https://mpadge.github.io/typetracer/reference/load_traces.html">the <code>load_traces()</code> function</a> simply loads all traces created in that session. <a href="https://mpadge.github.io/typetracer/reference/clear_traces.html">The function <code>clear_traces()</code></a> removes all traces, so that <a href="https://mpadge.github.io/typetracer/reference/load_traces.html"><code>load_traces()</code></a> will only load new traces produced after that time.</p>
<div class="section level3">
<h3 id="uninjecting-traces">Uninjecting Traces<a class="anchor" aria-label="anchor" href="#uninjecting-traces"></a>
</h3>
<p>It is important after applying <a href="https://mpadge.github.io/typetracer/reference/inject_tracer.html">the <code>inject_tracer()</code> function</a> to restore the functions back to their original form through calling <a href="https://mpadge.github.io/typetracer/reference/uninject_tracer.html">the obverse <code>uninject_tracer()</code> function</a>. For the function, <code>r</code>, above, this simply requires,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">uninject_tracer</span> (f)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>All traces can also be removed with this functions:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clear_traces</span> ()</span></code></pre></div>
<p>Because <code>typetracer</code> modifies the internal code of functions as defined within a current R session, we strongly recommend restarting your R session after using <code>typetracer</code>, to ensure expected function behaviour is restored.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-2---recursion-into-lists">Example #2 - Recursion into lists<a class="anchor" aria-label="anchor" href="#example-2---recursion-into-lists"></a>
</h2>
<p>R has extensive support for list structures, notably including all <code>data.frame</code>-like objects in which each column is actually a list item. <code>typetracer</code> also offers the ability to recurse into the list structures of individual parameters, to recursively trace the properties of each list item. To do this, the traces themselves have to be injected with the additional parameter, <code>trace_lists = TRUE</code>.</p>
<p>The final call above included an additional parameter passed as a list. The following code re-injects a tracer with the ability to traverse into list structures:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inject_tracer</span> (f, <span class="at">trace_lists =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>val <span class="ot">&lt;-</span> <span class="fu">f</span> (</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="fl">0.</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="st">"blah"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="fu">list</span> (<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="st">"b"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">f =</span> a <span class="sc">~</span> b</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>x_lists <span class="ot">&lt;-</span> <span class="fu">load_traces</span> ()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (x_lists)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 9 × 12</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   trace_number fn_name fn_call_hash par_name class     typeof mode  storage_mode</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">##          &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;    &lt;I&lt;list&gt;&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1            0 f       LzZIbYvx     x        &lt;chr [1]&gt; integ… nume… integer     </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2            0 f       LzZIbYvx     y        &lt;chr [1]&gt; double nume… double      </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 3            0 f       LzZIbYvx     z        &lt;chr [1]&gt; NULL   NULL  NULL        </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 4            0 f       LzZIbYvx     ...      &lt;chr [1]&gt; NULL   NULL  NULL        </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 5            0 f       LzZIbYvx     a        &lt;chr [1]&gt; chara… char… character   </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 6            0 f       LzZIbYvx     b        &lt;chr [1]&gt; list   list  list        </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 7            0 f       LzZIbYvx     f        &lt;chr [1]&gt; langu… call  language    </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 8            0 f       LzZIbYvx     b$a      &lt;chr [1]&gt; double nume… double      </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 9            0 f       LzZIbYvx     b$b      &lt;chr [1]&gt; chara… char… character   </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 4 more variables: length &lt;int&gt;, formal &lt;named list&gt;, uneval &lt;I&lt;list&gt;&gt;,</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="do">## #   eval &lt;I&lt;list&gt;&gt;</span></span></code></pre></div>
<p>And that result now has 9 rows, or 2 more than the previous example, reflecting the two items passed as a <code>list</code> to the parameter, <code>b</code>. List-parameter items are identifiable in typetracer output through the “dollar-notation” in the <code>par_name</code> field. The final two values in the above table are <code>b$a</code> and <code>b$b</code>, representing the two elements of the list passed as the parameter, <code>b</code>.</p>
</div>
<div class="section level2">
<h2 id="example-3---tracing-a-package">Example #3 - Tracing a Package<a class="anchor" aria-label="anchor" href="#example-3---tracing-a-package"></a>
</h2>
<p>This section presents a more complex example tracing all function calls from <a href="https://github.com/MangoTheCat/rematch" class="external-link">the <code>rematch</code> package</a>, chosen because it has less code than almost any other package on CRAN. The following single line traces function calls in all examples for the nominated package. <a href="https://mpadge.github.io/typetracer/reference/trace_package.html">The <code>trace_package()</code> function</a> automatically injects tracing code into every function within the package, so there is no need to explicitly call <a href="https://mpadge.github.io/typetracer/reference/inject_tracer">the <code>inject_tracer()</code> function</a>.</p>
<p>(This function also includes a <code>trace_lists</code> parameter, as demonstrated above, with a default of <code>FALSE</code> to not recurse into tracing list structures.)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">trace_package</span> (<span class="st">"rematch"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 8 × 14</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   trace_number source_file_name fn_name  fn_call_hash call_env par_name class   </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          &lt;int&gt; &lt;chr&gt;            &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;    &lt;I&lt;list&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1            0 man/re_match.Rd  re_match UJfHAIRp     &lt;NA&gt;     pattern  &lt;chr&gt;   </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2            0 man/re_match.Rd  re_match UJfHAIRp     &lt;NA&gt;     text     &lt;chr&gt;   </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3            0 man/re_match.Rd  re_match UJfHAIRp     &lt;NA&gt;     perl     &lt;chr&gt;   </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 4            0 man/re_match.Rd  re_match UJfHAIRp     &lt;NA&gt;     ...      &lt;chr&gt;   </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 5            1 man/re_match.Rd  re_match Anyflkea     &lt;NA&gt;     pattern  &lt;chr&gt;   </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 6            1 man/re_match.Rd  re_match Anyflkea     &lt;NA&gt;     text     &lt;chr&gt;   </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 7            1 man/re_match.Rd  re_match Anyflkea     &lt;NA&gt;     perl     &lt;chr&gt;   </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 8            1 man/re_match.Rd  re_match Anyflkea     &lt;NA&gt;     ...      &lt;chr&gt;   </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 7 more variables: typeof &lt;chr&gt;, mode &lt;chr&gt;, storage_mode &lt;chr&gt;,</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="do">## #   length &lt;int&gt;, formal &lt;named list&gt;, uneval &lt;I&lt;list&gt;&gt;, eval &lt;I&lt;list&gt;&gt;</span></span></code></pre></div>
<p>The <code>data.frame</code> returned by the <code><a href="reference/trace_package.html">trace_package()</a></code> function includes three more columns than the result directly returned by <code><a href="reference/load_traces.html">load_traces()</a></code>. These columns identify the sources and calling environments of each function call being traces. The “call_env” column identifies the calling environment which generated each trace, while “source_file_name” identifies the file.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span> (res<span class="sc">$</span>call_env)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NA</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span> (res<span class="sc">$</span>source_file_name)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "man/re_match.Rd"</span></span></code></pre></div>
<p>Although the “call_env” columns contains no useful information for that package, it includes information on the full environment in which each function was called. These “environments” include such things as <code>tryCatch</code> calls expected to generate errors, or the various <code>expect_</code> functions of the <a href="https://testthat.r-lib.org/" class="external-link">“testthat” package</a>. The above case of racing an installed package generally only extracts traces from example code, as documented in help, or <code>.Rd</code>, files. These are identified by the “rd_” prefix on the “source_file_name”, with the <code>rematch</code> package including only one <code>.Rd</code> file.</p>
<p><a href="https://mpadge.github.io/typetracer/reference/trace_package.html">The <code>trace_package()</code> function</a> also includes an additional parameter, <code>types</code>, which defaults to <code>c ("examples", "tests")</code>, so that traces are also by default generated for all tests included with local source packages (or for packages installed to include test files). The “source” column for test files identifies the names of each test, prefixed with “test_”.</p>
<p>The other two additional columns of “trace_file” and “call_env” respectively specify the source file and calling environment of each trace. These will generally only retain information from test files, in which case the source file will generally be the file name identified in the “source” column, and “call_env” will specify the environment from which that function call originated. Environments may, for example, include various types of expectation from the <a href="https://testthat.r-lib.org" class="external-link">“testthat” package</a>. These calling environments are useful to discern whether, for example, a call was made with an expectation that it should error.</p>
<div class="section level3">
<h3 id="example-3a---specifying-functions-to-trace">Example #3(a) - Specifying Functions to Trace<a class="anchor" aria-label="anchor" href="#example-3a---specifying-functions-to-trace"></a>
</h3>
<p><a href="https://mpadge.github.io/typetracer/reference/trace_package.html">The <code>trace_package()</code> function</a> also accepts an argument, <code>functions</code>, specifying which functions from a package should be traced. For example,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">trace_package</span> (<span class="st">"stats"</span>, <span class="at">functions =</span> <span class="st">"sd"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 × 16</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   trace_number trace_source fn_name fn_call_hash trace_file call_env par_name</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;   </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1            0 examples     sd      EzasZOKV     &lt;NA&gt;       &lt;NA&gt;     x       </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2            0 examples     sd      EzasZOKV     &lt;NA&gt;       &lt;NA&gt;     na.rm   </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 9 more variables: class &lt;I&lt;list&gt;&gt;, typeof &lt;chr&gt;, mode &lt;chr&gt;,</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="do">## #   storage_mode &lt;chr&gt;, length &lt;int&gt;, formal &lt;I&lt;list&gt;&gt;, uneval &lt;I&lt;list&gt;&gt;,</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">## #   eval &lt;I&lt;list&gt;&gt;, source &lt;chr&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="prior-art">Prior Art<a class="anchor" aria-label="anchor" href="#prior-art"></a>
</h2>
<p>This package extends on concepts previously developed in other R packages, notably including:</p>
<ul>
<li>The <a href="https://github.com/moodymudskipper/typed" class="external-link"><code>typed</code> package</a> by <a href="https://github.com/moodymudskipper" class="external-link">@moodymudskipper</a>
</li>
<li>The <a href="https://github.com/PRL-PRG/contractr" class="external-link"><code>contractr</code> package</a> by <a href="https://github.com/aviralg" class="external-link">@aviralg</a> &amp; <a href="https://github.com/fikovnik" class="external-link">@fikovnik</a>
</li>
</ul>
<p>Plus work explained in detail in this footnote:<br></p>
<p>[1] Alexi Turcotte &amp; Jan Vitek (2019), <em>Towards a Type System for R</em>, ICOOOLPS ’19: Proceedings of the 14th Workshop on Implementation, Compilation, Optimization of Object-Oriented Languages, Programs and Systems. Article No. 4, Pages 1–5, <a href="https://doi.org/10.1145/3340670.3342426" class="external-link uri">https://doi.org/10.1145/3340670.3342426</a></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=typetracer" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/mpadge/typetracer/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mpadge/typetracer/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing typetracer</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mark Padgham <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2172-5265" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mpadge/typetracer/actions" class="external-link"><img src="https://github.com/mpadge/typetracer/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/mpadge/typetracer" class="external-link"><img src="https://codecov.io/gh/mpadge/typetracer/branch/main/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://cran.r-project.org/package=typetracer/" class="external-link"><img src="https://www.r-pkg.org/badges/version/typetracer" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=typetracer" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/typetracer?color=orange" alt="CRAN Downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mark Padgham.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
